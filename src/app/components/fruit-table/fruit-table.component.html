<div class="container">
  <div class="row">
    <div class="col-12">
      <mat-card>
        <mat-card-header>
          <mat-card-title>Grassland Ventures Fruit Database:</mat-card-title>
        </mat-card-header>
        <mat-card-content>
          <input
            matInput
            (keyup)="applyFilter($event)"
            placeholder="fruit name or genus"
          />
          <select (change)="sortBy($event)" matInput>
            <option value="name">Name Ascending</option>
            <option value="nameDesc">Name Descending</option>
            <option value="carbohydrates">Carbohydrates Ascending</option>
            <option value="carbohydratesDesc">Carbohydrates Descending</option>
          </select>

          <table
            class="mat-table"
            mat-table
            [dataSource]="viewModel.filteredData$"
            matSort
          >
            <mat-text-column mat-sort-header name="name"></mat-text-column>
            <mat-text-column mat-sort-header name="id"></mat-text-column>
            <mat-text-column mat-sort-header name="genus"></mat-text-column>
            <ng-container mat-sort-header matColumnDef="calories">
              <th mat-sort-header mat-header-cell *matHeaderCellDef>
                Calories
              </th>
              <tr
                class="rows-alternate"
                mat-row
                *matRowDef="let myRowData; let fruit; columns: columnsToDisplay"
                [ngClass]="{
                  highlight:
                    fruit.nutritions.calories <= 50 &&
                    fruit.nutritions.sugar >= 8
                }"
              ></tr>

              <td
                mat-cell
                *matCellDef="let fruit"
                [style.fontWeight]="fruit.nutritions.calories <= 50 ? 700 : 400"
              >
                {{ fruit.nutritions.calories }}
              </td>
            </ng-container>
            <ng-container matColumnDef="carbohydrates" mat-sort-header>
              <th mat-header-cell *matHeaderCellDef>Carbohydrates</th>
              <td mat-cell *matCellDef="let fruit">
                {{ fruit.nutritions.carbohydrates }}
              </td>
            </ng-container>
            <ng-container matColumnDef="sugar" mat-sort-header>
              <th mat-header-cell *matHeaderCellDef>Sugar</th>
              <td class="last-column" mat-cell *matCellDef="let fruit">
                {{ fruit.nutritions.sugar }}
              </td>
            </ng-container>
            <tr mat-header-row *matHeaderRowDef="columnsToDisplay"></tr>
            <tr
              mat-row
              *matRowDef="let myRowData; columns: columnsToDisplay"
            ></tr>
          </table>
          <div
            class="loading-spinner-container"
            *ngIf="!!(viewModel.loadingFruit$ | async)"
          >
            <mat-progress-spinner
              mode="indeterminate"
              color="primary"
            ></mat-progress-spinner>
          </div>
        </mat-card-content>
      </mat-card>
    </div>
  </div>
</div>
